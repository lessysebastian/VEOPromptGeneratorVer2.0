<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEO PROMPT GENERATOR APP BY LESSY SEBASTIAN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            border: 1px solid #e5e7eb;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        .input, .select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            background-color: #f9fafb;
            color: #1f2937;
            transition: border-color 0.2s;
        }
        .input:focus, .select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.4);
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s;
            text-align: center;
        }
        .btn-primary {
            background-color: #2563eb;
        }
        .btn-primary:hover {
            background-color: #1d4ed8;
        }
        .btn-secondary {
            background-color: #4b5563;
        }
        .btn-secondary:hover {
            background-color: #374151;
        }
        .btn-tertiary {
            background-color: #16a34a;
        }
        .btn-tertiary:hover {
            background-color: #15803d;
        }
        .result-box {
            background-color: #1f2937;
            color: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            min-height: 150px;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: monospace;
        }
        .character-block {
            border: 2px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-top: 1rem;
        }
        .dialog-character-block {
            border: 1px dashed #9ca3af;
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0.5rem;
        }
        .dialog-entry {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        .hidden {
            display: none;
        }
        /* Styles for Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            z-index: 999;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            width: 90%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 10px 25px -5px rgb(0 0 0 / 0.2);
            position: relative;
        }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #6b7280;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-6 md:p-8">

    <!-- Access Code Modal -->
    <div id="access-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <h2 class="text-xl font-bold text-gray-800 mb-2">Exclusive Access</h2>
            <p class="text-gray-600 mb-4">This tool is for followers. Please enter the access code to continue.</p>
            <input type="password" id="access-code-input" class="input text-center" placeholder="Enter Access Code">
            <p id="error-message" class="text-red-500 text-sm mt-2 h-5"></p>
            <button id="submit-access-code" class="btn btn-primary w-full mt-2">Enter</button>
        </div>
    </div>

    <!-- Admin Authentication Modal -->
    <div id="admin-auth-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-admin-auth-btn" class="close-btn">&times;</button>
            <h2 class="text-xl font-bold text-gray-800 mb-2">Admin Verification</h2>
            <p class="text-gray-600 mb-4">Please enter the admin code to access settings.</p>
            <input type="password" id="admin-code-input" class="input text-center" placeholder="Enter Admin Code">
            <p id="admin-error-message" class="text-red-500 text-sm mt-2 h-5"></p>
            <button id="submit-admin-code" class="btn btn-primary w-full mt-2">Verify</button>
            <a href="#" id="forgot-codes-link" class="text-xs text-gray-500 hover:underline mt-4 block">Forgot codes? Emergency Reset</a>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-settings-btn" class="close-btn">&times;</button>
            <h2 class="text-xl font-bold text-gray-800 mb-4">Admin Settings</h2>
            <div class="space-y-4 text-left">
                <div>
                    <label for="new-access-code-input" class="label">Change User Access Code</label>
                    <input type="text" id="new-access-code-input" class="input" placeholder="Enter new user code">
                    <button id="save-access-code-btn" class="btn btn-primary w-full mt-2 text-sm">Save User Code</button>
                </div>
                <hr>
                <div>
                    <label for="new-admin-code-input" class="label">Change Admin Code</label>
                    <input type="text" id="new-admin-code-input" class="input" placeholder="Enter new admin code">
                     <button id="save-admin-code-btn" class="btn btn-primary w-full mt-2 text-sm">Save Admin Code</button>
                </div>
            </div>
            <p id="settings-feedback" class="text-green-600 font-medium mt-4 h-5"></p>
        </div>
    </div>

    <div id="main-content" class="max-w-4xl mx-auto hidden">
        <header class="text-center mb-8 relative">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">VEO PROMPT GENERATOR VER 2.0</h1>
            <p class="text-lg text-gray-600 mt-2">BY LESSY SEBASTIAN</p>
        </header>

        <main id="prompt-form">
            <!-- Subject and Action Details -->
            <div class="card">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-gray-700">1. Characters & Actions</h2>
                    <button id="add-character-btn-main" class="btn btn-secondary text-sm">+ Add Character</button>
                </div>
                <div id="character-container">
                    <!-- Character blocks will be dynamically inserted here -->
                </div>
            </div>

            <!-- Environment and Atmosphere -->
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">2. Environment and Atmosphere</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="lokasi" class="label">Location</label>
                        <input type="text" id="lokasi" class="input" placeholder="e.g., Planet Mars, enchanted forest, metropolis">
                    </div>
                    <div>
                        <label for="waktu" class="label">Time of Day</label>
                        <select id="waktu" class="select manual-trigger" data-target="waktu-manual">
                            <option value="">Select Time</option>
                            <option value="morning (golden hour)">Morning (Golden Hour)</option>
                            <option value="bright midday">Bright Midday</option>
                            <option value="afternoon (magic hour)">Afternoon (Magic Hour)</option>
                            <option value="dusk">Dusk</option>
                            <option value="night">Night</option>
                            <option value="midnight">Midnight</option>
                            <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="waktu-manual" class="input mt-2 hidden" placeholder="Enter custom time of day...">
                    </div>
                    <div>
                        <label for="cuaca" class="label">Weather</label>
                        <input type="text" id="cuaca" class="input" placeholder="e.g., Sunny, stormy, foggy, snowy">
                    </div>
                     <div>
                        <label for="musim" class="label">Season</label>
                        <select id="musim" class="select manual-trigger" data-target="musim-manual">
                            <option value="">Select Season</option>
                            <option value="spring">Spring</option>
                            <option value="summer">Summer</option>
                            <option value="autumn">Autumn</option>
                            <option value="winter">Winter</option>
                            <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="musim-manual" class="input mt-2 hidden" placeholder="Enter custom season...">
                    </div>
                </div>
            </div>

            <!-- Cinematography -->
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">3. Cinematography</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="gaya" class="label">Visual Style</label>
                        <input type="text" id="gaya" class="input" placeholder="e.g., Cinematic style, anime, nature documentary">
                    </div>
                    <div>
                        <label for="posisiKamera" class="label">Camera Position</label>
                         <select id="posisiKamera" class="select manual-trigger" data-target="posisiKamera-manual">
                           <option value="">Select Position</option>
                           <option value="from the front">From the front</option>
                           <option value="from behind">From behind</option>
                           <option value="from the left side">From the left side</option>
                           <option value="from the right side">From the right side</option>
                           <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="posisiKamera-manual" class="input mt-2 hidden" placeholder="Enter custom camera position...">
                    </div>
                    <div>
                        <label for="pergerakanKamera" class="label">Camera Movement</label>
                        <select id="pergerakanKamera" class="select manual-trigger" data-target="pergerakanKamera-manual">
                           <option value="">Select Movement</option>
                           <option value="dolly shot">Dolly Shot</option>
                           <option value="panning shot">Panning Shot</option>
                           <option value="crane shot">Crane Shot</option>
                           <option value="handheld">Handheld</option>
                           <option value="static shot">Static Shot</option>
                           <option value="zoom in/out">Zoom In/Out</option>
                           <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="pergerakanKamera-manual" class="input mt-2 hidden" placeholder="Enter custom camera movement...">
                    </div>
                    <div>
                        <label for="sudutKamera" class="label">Camera Angle</label>
                         <select id="sudutKamera" class="select manual-trigger" data-target="sudutKamera-manual">
                           <option value="">Select Angle</option>
                           <option value="eye-level shot">Eye-Level Shot</option>
                           <option value="low-angle shot">Low-Angle Shot</option>
                           <option value="high-angle shot">High-Angle Shot</option>
                           <option value="bird's-eye view">Bird's-Eye View</option>
                           <option value="dutch angle">Dutch Angle</option>
                           <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="sudutKamera-manual" class="input mt-2 hidden" placeholder="Enter custom camera angle...">
                    </div>
                    <div>
                        <label for="panjangFokus" class="label">Focal Length (Lens)</label>
                         <select id="panjangFokus" class="select manual-trigger" data-target="panjangFokus-manual">
                           <option value="">Select Lens</option>
                           <option value="wide-angle lens">Wide-Angle Lens</option>
                           <option value="telephoto lens">Telephoto Lens</option>
                           <option value="macro lens">Macro Lens</option>
                           <option value="fisheye lens">Fisheye Lens</option>
                           <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="panjangFokus-manual" class="input mt-2 hidden" placeholder="Enter custom focal length...">
                    </div>
                     <div>
                        <label for="pencahayaan" class="label">Lighting</label>
                        <input type="text" id="pencahayaan" class="input" placeholder="e.g., Dramatic lighting, high-key, low-key, neon">
                    </div>
                     <div>
                        <label for="paletWarna" class="label">Color Palette/Grading</label>
                        <input type="text" id="paletWarna" class="input" placeholder="e.g., Vibrant colors, monochromatic, pastel">
                    </div>
                </div>
            </div>
            
            <!-- Audio -->
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">4. Audio</h2>
                <div id="audio-main-section">
                     <label class="label font-semibold">Dialogue (Auto-synced with characters)</label>
                     <div id="dialogue-container">
                        <!-- Dialogue blocks will be auto-inserted here -->
                     </div>
                </div>
                <hr class="my-6">
                <label class="label font-semibold">Overall Audio Scene</label>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                     <div>
                        <label for="suasanaSuara" class="label">Sound Ambiance</label>
                        <input type="text" id="suasanaSuara" class="input" placeholder="e.g., Sound of wind, city rumble, birds chirping">
                    </div>
                    <div>
                        <label for="musikLatar" class="label">Background Music</label>
                        <input type="text" id="musikLatar" class="input" placeholder="e.g., Epic orchestral music, lo-fi hip hop, no music">
                    </div>
                    <div>
                        <label for="soundEfek" class="label">Sound Effects</label>
                        <input type="text" id="soundEfek" class="input" placeholder="e.g., Explosion sounds, footsteps, magic spells">
                    </div>
                    <div>
                        <label for="volume" class="label">Volume</label>
                        <input type="text" id="volume" class="input" placeholder="e.g., Soft background music, clear dialogue">
                    </div>
                    <div>
                        <label for="audioTransisi" class="label">Audio Transition</label>
                        <input type="text" id="audioTransisi" class="input" placeholder="e.g., J-cut, L-cut, fade in/out">
                    </div>
                </div>
            </div>

             <!-- Technical Parameters -->
            <div class="card">
                <h2 class="text-xl font-bold mb-4 text-gray-700">5. Technical Parameters</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="kualitasVisual" class="label">Visual Quality</label>
                        <select id="kualitasVisual" class="select manual-trigger" data-target="kualitasVisual-manual">
                           <option value="high quality">High Quality</option>
                           <option value="4K">4K</option>
                           <option value="8K">8K</option>
                           <option value="photorealistic">Photorealistic</option>
                           <option value="hyperrealistic">Hyperrealistic</option>
                           <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="kualitasVisual-manual" class="input mt-2 hidden" placeholder="Enter custom visual quality...">
                    </div>
                    <div>
                        <label for="aspekRasio" class="label">Visual Format / Aspect Ratio</label>
                        <select id="aspekRasio" class="select manual-trigger" data-target="aspekRasio-manual">
                           <option value="16:9 (widescreen)">16:9 (Widescreen)</option>
                           <option value="9:16 (vertical)">9:16 (Vertical)</option>
                           <option value="1:1 (square)">1:1 (Square)</option>
                           <option value="2.35:1 (cinemascope)">2.35:1 (Cinemascope)</option>
                           <option value="manual">Other (Manual)</option>
                        </select>
                        <input type="text" id="aspekRasio-manual" class="input mt-2 hidden" placeholder="Enter custom aspect ratio...">
                    </div>
                    <div class="md:col-span-2">
                        <label for="detailTambahan" class="label">Additional Details</label>
                        <textarea id="detailTambahan" class="input" rows="3" placeholder="Write any other relevant details here..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Prompt Result -->
            <div class="mt-8">
                 <button id="generate-btn" class="btn btn-primary w-full text-lg">Generate Prompt</button>
                 <div class="mt-6">
                    <h3 class="text-xl font-bold mb-2 text-gray-700">Generated Prompt:</h3>
                    <div id="result" class="result-box">Your prompt will appear here...</div>
                    <div class="flex gap-2 mt-2">
                      <button id="copy-btn" class="btn btn-secondary w-full">Copy Prompt</button>
                      <button id="share-btn" class="btn btn-tertiary w-full">Share App Link</button>
                    </div>
                    <div id="copy-feedback" class="text-center text-green-600 font-medium mt-2 h-5"></div>
                 </div>
            </div>
        </main>
         <footer class="text-center mt-12 mb-6 flex justify-center items-center gap-4">
            <p class="text-gray-500">App created for the community by Lessy Sebastian. Happy creating!</p>
            <button id="open-settings-btn" title="Admin Settings">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500 hover:text-gray-800 transition-colors"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2.4l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l-.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2.4l.15.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            </button>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Elements ---
            const mainContent = document.getElementById('main-content');
            const accessModalOverlay = document.getElementById('access-modal-overlay');
            const adminAuthModalOverlay = document.getElementById('admin-auth-modal-overlay');
            const settingsModalOverlay = document.getElementById('settings-modal-overlay');
            const accessCodeInput = document.getElementById('access-code-input');
            const submitAccessCodeBtn = document.getElementById('submit-access-code');
            const errorMessage = document.getElementById('error-message');
            const adminCodeInput = document.getElementById('admin-code-input');
            const submitAdminCodeBtn = document.getElementById('submit-admin-code');
            const adminErrorMessage = document.getElementById('admin-error-message');
            const closeAdminAuthBtn = document.getElementById('close-admin-auth-btn');
            const forgotCodesLink = document.getElementById('forgot-codes-link');
            const openSettingsBtn = document.getElementById('open-settings-btn');
            const closeSettingsBtn = document.getElementById('close-settings-btn');
            const newAccessCodeInput = document.getElementById('new-access-code-input');
            const saveAccessCodeBtn = document.getElementById('save-access-code-btn');
            const newAdminCodeInput = document.getElementById('new-admin-code-input');
            const saveAdminCodeBtn = document.getElementById('save-admin-code-btn');
            const settingsFeedback = document.getElementById('settings-feedback');
            const characterContainer = document.getElementById('character-container');
            const dialogueContainer = document.getElementById('dialogue-container');
            const addCharacterBtnMain = document.getElementById('add-character-btn-main');

            // --- Config ---
            const config = {
                defaultAccessCode: 'VEOBYLESSY',
                defaultAdminCode: 'ADMINMASTER',
                accessCodeKey: 'veoPromptAccessCode',
                adminCodeKey: 'veoPromptAdminCode'
            };
            
            // --- State ---
            let characterCount = 0;

            // --- Core Functions ---
            function checkAccessCode() {
                const currentAccessCode = localStorage.getItem(config.accessCodeKey) || config.defaultAccessCode;
                if (accessCodeInput.value.trim() === currentAccessCode) {
                    accessModalOverlay.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                } else {
                    errorMessage.textContent = 'Incorrect code. Please try again.';
                    accessCodeInput.value = '';
                }
            }
            
            function checkAdminCode() {
                const currentAdminCode = localStorage.getItem(config.adminCodeKey) || config.defaultAdminCode;
                if (adminCodeInput.value.trim() === currentAdminCode) {
                    adminAuthModalOverlay.classList.add('hidden');
                    settingsModalOverlay.classList.remove('hidden');
                    adminErrorMessage.textContent = '';
                    adminCodeInput.value = '';
                } else {
                    adminErrorMessage.textContent = 'Incorrect admin code.';
                    adminCodeInput.value = '';
                }
            }
            
            function emergencyReset() {
                 const isConfirmed = confirm("This is an admin-only function. Are you sure you want to reset all codes to their factory defaults? This action cannot be undone.");
                 if (isConfirmed) {
                    localStorage.removeItem(config.accessCodeKey);
                    localStorage.removeItem(config.adminCodeKey);
                    alert('Codes have been reset to default. The application will now reload.');
                    location.reload();
                 }
            }

            function showFeedback(element, message) {
                element.textContent = message;
                setTimeout(() => { element.textContent = '' }, 3000);
            }

            function saveNewAccessCode() {
                const newCode = newAccessCodeInput.value.trim();
                if (newCode) {
                    localStorage.setItem(config.accessCodeKey, newCode);
                    showFeedback(settingsFeedback, 'User access code updated!');
                    newAccessCodeInput.value = '';
                } else {
                    showFeedback(settingsFeedback, 'User code cannot be empty.');
                }
            }
            
            function saveNewAdminCode() {
                const newCode = newAdminCodeInput.value.trim();
                if (newCode) {
                    localStorage.setItem(config.adminCodeKey, newCode);
                    showFeedback(settingsFeedback, 'Admin code updated!');
                    newAdminCodeInput.value = '';
                } else {
                    showFeedback(settingsFeedback, 'Admin code cannot be empty.');
                }
            }

             function addCharacter() {
                characterCount++;
                
                // Create Character Block in Section 1
                const charBlock = document.createElement('div');
                charBlock.className = 'character-block';
                charBlock.id = `character-block-${characterCount}`;
                charBlock.innerHTML = `
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">Character ${characterCount}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="subject-${characterCount}" class="label">Main Subject</label>
                            <input type="text" id="subject-${characterCount}" class="input character-subject" placeholder="e.g., A brave knight, a curious cat">
                        </div>
                        <div>
                            <label for="characteristics-${characterCount}" class="label">Subject Characteristics</label>
                            <input type="text" id="characteristics-${characterCount}" class="input character-characteristics" placeholder="e.g., In shining armor, with fluffy white fur">
                        </div>
                        <div>
                            <label for="action-${characterCount}" class="label">Main Action</label>
                            <input type="text" id="action-${characterCount}" class="input character-action" placeholder="e.g., Fighting a dragon, chasing a butterfly">
                        </div>
                        <div>
                            <label for="emotion-${characterCount}" class="label">Emotion</label>
                            <input type="text" id="emotion-${characterCount}" class="input character-emotion" placeholder="e.g., Determined, playful, scared">
                        </div>
                    </div>
                `;
                characterContainer.appendChild(charBlock);

                // Create corresponding Dialogue Block in Section 4
                const dialogueBlock = document.createElement('div');
                dialogueBlock.className = 'dialog-character-block';
                dialogueBlock.id = `dialog-block-${characterCount}`;
                dialogueBlock.innerHTML = `
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                        <div>
                            <label class="label text-sm">Language & Accent (Character ${characterCount})</label>
                            <input type="text" id="lang-${characterCount}" class="input dialogue-lang" placeholder="e.g., English, British accent">
                        </div>
                        <div>
                            <label class="label text-sm">Dialogue (Character ${characterCount})</label>
                            <input type="text" id="dialogue-${characterCount}" class="input dialogue-text" placeholder="Dialogue content...">
                        </div>
                    </div>
                `;
                dialogueContainer.appendChild(dialogueBlock);
            }

            // --- Event Listeners ---
            submitAccessCodeBtn.addEventListener('click', checkAccessCode);
            accessCodeInput.addEventListener('keypress', e => e.key === 'Enter' && checkAccessCode());
            
            openSettingsBtn.addEventListener('click', () => {
                adminAuthModalOverlay.classList.remove('hidden');
            });
            
            closeAdminAuthBtn.addEventListener('click', () => {
                 adminAuthModalOverlay.classList.add('hidden');
                 adminErrorMessage.textContent = '';
                 adminCodeInput.value = '';
            });

            submitAdminCodeBtn.addEventListener('click', checkAdminCode);
            adminCodeInput.addEventListener('keypress', e => e.key === 'Enter' && checkAdminCode());
            
            forgotCodesLink.addEventListener('click', function(e) {
                e.preventDefault();
                emergencyReset();
            });

            closeSettingsBtn.addEventListener('click', () => {
                settingsModalOverlay.classList.add('hidden');
            });

            saveAccessCodeBtn.addEventListener('click', saveNewAccessCode);
            saveAdminCodeBtn.addEventListener('click', saveNewAdminCode);
            
            addCharacterBtnMain.addEventListener('click', addCharacter);


            // --- Main App Logic ---
            const generateBtn = document.getElementById('generate-btn');
            
            document.querySelectorAll('.manual-trigger').forEach(selectElement => {
                selectElement.addEventListener('change', function() {
                    const targetId = this.dataset.target;
                    const targetInput = document.getElementById(targetId);
                    if (this.value === 'manual') {
                        targetInput.classList.remove('hidden');
                    } else {
                        targetInput.classList.add('hidden');
                        targetInput.value = '';
                    }
                });
            });

            function getFieldValue(selectId, manualInputId) {
                const select = document.getElementById(selectId);
                if (select.value === 'manual') {
                    return document.getElementById(manualInputId).value.trim();
                }
                return select.value;
            }

            generateBtn.addEventListener('click', function() {
                let prompt = 'Create a video with the following details:\n\n';

                // 1. Characters
                prompt += `**Characters & Actions:**\n`;
                for (let i = 1; i <= characterCount; i++) {
                    const subject = document.getElementById(`subject-${i}`).value.trim();
                    const characteristics = document.getElementById(`characteristics-${i}`).value.trim();
                    const action = document.getElementById(`action-${i}`).value.trim();
                    const emotion = document.getElementById(`emotion-${i}`).value.trim();
                    
                    if (subject) {
                        let charDesc = `- **Character ${i}:** ${subject}`;
                        if (characteristics) charDesc += ` ${characteristics}`;
                        if (action) charDesc += `, who is ${action}`;
                        if (emotion) charDesc += ` while feeling ${emotion}`;
                        prompt += `${charDesc}.\n`;
                    }
                }
                
                // 2. Environment
                const fieldsEnv = {
                    location: document.getElementById('lokasi').value.trim(),
                    time: getFieldValue('waktu', 'waktu-manual'),
                    weather: document.getElementById('cuaca').value.trim(),
                    season: getFieldValue('musim', 'musim-manual'),
                };
                let envPart = '';
                if (fieldsEnv.location) envPart += `Located in ${fieldsEnv.location}`;
                if (fieldsEnv.time) envPart += `, at ${fieldsEnv.time}`;
                if (fieldsEnv.weather) envPart += ` with ${fieldsEnv.weather} weather`;
                if (fieldsEnv.season) envPart += ` during ${fieldsEnv.season}`;
                if (envPart) prompt += `\n**Environment:** ${envPart}.\n`;

                // 3. Cinematography
                const fieldsCinema = {
                    style: document.getElementById('gaya').value.trim(),
                    position: getFieldValue('posisiKamera', 'posisiKamera-manual'),
                    movement: getFieldValue('pergerakanKamera', 'pergerakanKamera-manual'),
                    angle: getFieldValue('sudutKamera', 'sudutKamera-manual'),
                    focus: getFieldValue('panjangFokus', 'panjangFokus-manual'),
                    lighting: document.getElementById('pencahayaan').value.trim(),
                    color: document.getElementById('paletWarna').value.trim(),
                };
                let cinemaPart = '';
                if (fieldsCinema.style) cinemaPart += `Use a ${fieldsCinema.style} visual style`;
                else { cinemaPart += 'Use a cinematic style' }
                if (fieldsCinema.position) cinemaPart += `, filmed ${fieldsCinema.position}`;
                if (fieldsCinema.movement) cinemaPart += `, with ${fieldsCinema.movement} camera movement`;
                if (fieldsCinema.angle) cinemaPart += `, a ${fieldsCinema.angle}`;
                if (fieldsCinema.focus) cinemaPart += `, and a ${fieldsCinema.focus}`;
                if (cinemaPart) prompt += `\n**Cinematography:** ${cinemaPart}.\n`;
                if (fieldsCinema.lighting) prompt += `**Lighting:** ${fieldsCinema.lighting}.\n`;
                if (fieldsCinema.color) prompt += `**Color Palette:** ${fieldsCinema.color}.\n`;

                // 4. Audio
                let audioPart = '';
                let dialogueContent = '';
                for (let i = 1; i <= characterCount; i++) {
                    const lang = document.getElementById(`lang-${i}`).value.trim();
                    const dialogue = document.getElementById(`dialogue-${i}`).value.trim();
                    if (dialogue) {
                        dialogueContent += `- Character ${i}`;
                        if (lang) dialogueContent += ` (${lang})`;
                        dialogueContent += `: "${dialogue}"\n`;
                    }
                }
                if (dialogueContent) {
                    audioPart += `**Dialogue:**\n${dialogueContent}`;
                }

                const fieldsAudio = {
                    ambiance: document.getElementById('suasanaSuara').value.trim(),
                    music: document.getElementById('musikLatar').value.trim(),
                    sfx: document.getElementById('soundEfek').value.trim(),
                    volume: document.getElementById('volume').value.trim(),
                    audioTransition: document.getElementById('audioTransisi').value.trim(),
                };
                let sceneAudio = '';
                if (fieldsAudio.ambiance) sceneAudio += `**Sound Ambiance:** ${fieldsAudio.ambiance}.\n`;
                if (fieldsAudio.music) sceneAudio += `**Background Music:** ${fieldsAudio.music}.\n`;
                if (fieldsAudio.sfx) sceneAudio += `**Sound Effects:** ${fieldsAudio.sfx}.\n`;
                if (fieldsAudio.volume) sceneAudio += `**Volume:** ${fieldsAudio.volume}.\n`;
                if (fieldsAudio.audioTransition) sceneAudio += `**Audio Transition:** ${fieldsAudio.audioTransition}.\n`;
                
                if (audioPart && sceneAudio) {
                    prompt += `\n**Audio:**\n${audioPart}${sceneAudio}`;
                } else if (audioPart) {
                     prompt += `\n**Audio:**\n${audioPart}`;
                } else if (sceneAudio) {
                    prompt += `\n**Audio:**\n${sceneAudio}`;
                }


                // 5. Technical
                const fieldsTech = {
                    quality: getFieldValue('kualitasVisual', 'kualitasVisual-manual'),
                    ratio: getFieldValue('aspekRasio', 'aspekRasio-manual'),
                    additional: document.getElementById('detailTambahan').value.trim(),
                };
                let techPart = `In ${fieldsTech.ratio} format with ${fieldsTech.quality}`;
                prompt += `\n**Technical Parameters:** ${techPart}.\n`;
                if (fieldsTech.additional) {
                    prompt += `\n**Additional Details:** ${fieldsTech.additional}.\n`;
                }
                
                document.getElementById('result').textContent = prompt.replace(/\n\n\n/g, '\n\n').trim();
            });
            
            function copyToClipboard(text, successMessage, failureMessage) {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.top = '-9999px';
                textArea.style.left = '-9999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    const successful = document.execCommand('copy');
                    document.getElementById('copy-feedback').textContent = successful ? successMessage : failureMessage;
                } catch (err) {
                    document.getElementById('copy-feedback').textContent = failureMessage;
                }
                document.body.removeChild(textArea);
                setTimeout(() => { document.getElementById('copy-feedback').textContent = '' }, 3000);
            }

            document.getElementById('copy-btn').addEventListener('click', function() {
                const textToCopy = document.getElementById('result').textContent;
                if (textToCopy === 'Your prompt will appear here...') return;
                copyToClipboard(textToCopy, 'Prompt copied successfully!', 'Failed to copy prompt.');
            });

            document.getElementById('share-btn').addEventListener('click', function() {
                 const url = window.location.href;
                 copyToClipboard(url, 'App link copied! Share it with your friends.', 'Failed to copy link.');
            });
            
            // Initialize with one character
            addCharacter();
        });
    </script>
</body>
</html>
